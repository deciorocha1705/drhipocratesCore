using System;using System.Collections.Generic;using System.Data;using System.Linq;using System.Threading.Tasks;using drhipocratesCore.Config;using drhipocratesCore.Model;using MySql.Data;using MySql.Data.MySqlClient;namespace drhipocratesCore.Repository{   public class NiveisRepository   {      String connect = Connect.getConnect;              public List<Niveis> List()         {             MySqlConnection conn = new MySqlConnection(connect);             System.Text.StringBuilder query = new System.Text.StringBuilder();             query.Append("select idniveis, numeronivel, tipocomissionamento, valorcomissaoativacao, valorcomissaoecommerce, tipoadesao from niveis");                  MySqlCommand comm = new MySqlCommand(query.ToString(), conn);             MySqlDataReader dr = null;             List<Niveis> lista = new List<Niveis>();                  try             {                 conn.Open();                 dr = comm.ExecuteReader(CommandBehavior.CloseConnection);                      while (dr.Read())                     {                     Niveis unitario = new Niveis();                          unitario.idniveis = dr.IsDBNull(0) ? 0 : dr.GetInt32(0);                     unitario.numeronivel = dr.IsDBNull(1) ? 0 : dr.GetInt32(1);                     unitario.tipocomissionamento = dr.IsDBNull(2) ? 0 : dr.GetInt32(2);                     unitario.valorcomissaoativacao = dr.IsDBNull(3) ? 0 : dr.GetFloat(3);                     unitario.valorcomissaoecommerce = dr.IsDBNull(4) ? 0 : dr.GetFloat(4);                     unitario.tipoadesao = dr.IsDBNull(5) ? 0 : dr.GetInt32(5);                          lista.Add(unitario);                     }             }             catch (Exception ex)             {                 string ERRO = ex.Message;                 return new List<Niveis>();             }             finally             { conn.Close(); }                  return lista;         }              public Niveis Get(int primary_key)         {             MySqlConnection conn = new MySqlConnection(connect);             System.Text.StringBuilder query = new System.Text.StringBuilder();             query.Append("select idniveis, numeronivel, tipocomissionamento, valorcomissaoativacao, valorcomissaoecommerce, tipoadesao from niveis where idniveis = @idniveis");                  MySqlCommand comm = new MySqlCommand(query.ToString(), conn);             comm.Parameters.Add("@idniveis", MySqlDbType.Int32);             comm.Parameters[0].Value = primary_key;             MySqlDataReader dr = null;             Niveis lista = new Niveis();             try             {                 conn.Open();                 dr = comm.ExecuteReader(CommandBehavior.CloseConnection);                      while (dr.Read())                     {                     Niveis unitario = new Niveis();                          unitario.idniveis = dr.IsDBNull(0) ? 0 : dr.GetInt32(0);                     unitario.numeronivel = dr.IsDBNull(1) ? 0 : dr.GetInt32(1);                     unitario.tipocomissionamento = dr.IsDBNull(2) ? 0 : dr.GetInt32(2);                     unitario.valorcomissaoativacao = dr.IsDBNull(3) ? 0 : dr.GetFloat(3);                     unitario.valorcomissaoecommerce = dr.IsDBNull(4) ? 0 : dr.GetFloat(4);                     unitario.tipoadesao = dr.IsDBNull(5) ? 0 : dr.GetInt32(5);                          lista = unitario;                     }             }             catch (Exception ex)             {                 string ERRO = ex.Message;                 return new Niveis();             }             finally             { conn.Close(); }                  return lista;         }    public int Post(Niveis niveis)    {        MySqlConnection conn = new MySqlConnection(connect);        System.Text.StringBuilder query = new System.Text.StringBuilder();        query.Append("insert into niveis (numeronivel, tipocomissionamento, valorcomissaoativacao, valorcomissaoecommerce, tipoadesao) values (@numeronivel, @tipocomissionamento, @valorcomissaoativacao, @valorcomissaoecommerce, @tipoadesao)");        MySqlCommand comm = new MySqlCommand(query.ToString(), conn);        comm.Parameters.Add("@numeronivel", MySqlDbType.Int32 );        comm.Parameters.Add("@tipocomissionamento", MySqlDbType.Int32 );        comm.Parameters.Add("@valorcomissaoativacao", MySqlDbType.Float );        comm.Parameters.Add("@valorcomissaoecommerce", MySqlDbType.Float );        comm.Parameters.Add("@tipoadesao", MySqlDbType.Int32 );        comm.Parameters[0].Value = niveis.numeronivel;        comm.Parameters[1].Value = niveis.tipocomissionamento;        comm.Parameters[2].Value = niveis.valorcomissaoativacao;        comm.Parameters[3].Value = niveis.valorcomissaoecommerce;        comm.Parameters[4].Value = niveis.tipoadesao;        Int32 id = 0;        try        {            conn.Open();            comm.ExecuteNonQuery();            query.Clear();            query.Append("Select @@Identity");            comm.CommandText = query.ToString();            var resultado = comm.ExecuteScalar();            id = Convert.ToInt32(resultado);        }        catch (Exception ex)        {            string ERRO = ex.Message;            return 0;        }        finally        { conn.Close(); }        return id;    }    public int Put(Niveis niveis)    {        MySqlConnection conn = new MySqlConnection(connect);        System.Text.StringBuilder query = new System.Text.StringBuilder();        query.Append("update niveis set idniveis = @idniveis, numeronivel = @numeronivel, tipocomissionamento = @tipocomissionamento, valorcomissaoativacao = @valorcomissaoativacao, valorcomissaoecommerce = @valorcomissaoecommerce, tipoadesao = @tipoadesao where idniveis = @idniveis");        MySqlCommand comm = new MySqlCommand(query.ToString(), conn);        comm.Parameters.Add("@idniveis", MySqlDbType.Int32 );        comm.Parameters.Add("@numeronivel", MySqlDbType.Int32 );        comm.Parameters.Add("@tipocomissionamento", MySqlDbType.Int32 );        comm.Parameters.Add("@valorcomissaoativacao", MySqlDbType.Float );        comm.Parameters.Add("@valorcomissaoecommerce", MySqlDbType.Float );        comm.Parameters.Add("@tipoadesao", MySqlDbType.Int32 );        comm.Parameters[0].Value = niveis.idniveis;        comm.Parameters[1].Value = niveis.numeronivel;        comm.Parameters[2].Value = niveis.tipocomissionamento;        comm.Parameters[3].Value = niveis.valorcomissaoativacao;        comm.Parameters[4].Value = niveis.valorcomissaoecommerce;        comm.Parameters[5].Value = niveis.tipoadesao;        try        {            conn.Open();            return comm.ExecuteNonQuery();        }        catch (Exception ex)        {            string ERRO = ex.Message;            return 0;        }        finally        { conn.Close(); }    }    public int Delete(int idniveis)    {        MySqlConnection conn = new MySqlConnection(connect);        System.Text.StringBuilder query = new System.Text.StringBuilder();        query.Append("delete from niveis where idniveis = @idniveis");        MySqlCommand comm = new MySqlCommand(query.ToString(), conn);        comm.Parameters.Add("@idniveis", MySqlDbType.Int32 );        comm.Parameters[0].Value = idniveis;        try        {            conn.Open();            return comm.ExecuteNonQuery();        }        catch (Exception ex)        {            string ERRO = ex.Message;            return 0;        }        finally        { conn.Close(); }    }   }}