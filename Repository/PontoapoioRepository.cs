using System;using System.Collections.Generic;using System.Data;using System.Linq;using System.Threading.Tasks;using drhipocratesCore.Config;using drhipocratesCore.Model;using MySql.Data;using MySql.Data.MySqlClient;namespace drhipocratesCore.Repository{   public class PontoapoioRepository   {      String connect = Connect.getConnect;              public List<Pontoapoio> List()         {             MySqlConnection conn = new MySqlConnection(connect);             System.Text.StringBuilder query = new System.Text.StringBuilder();             query.Append("select idpontoapoio, descricao, idassociado, tipoendereco, logradouro, numero, complemento, bairro, cidade, estado from pontoapoio");                  MySqlCommand comm = new MySqlCommand(query.ToString(), conn);             MySqlDataReader dr = null;             List<Pontoapoio> lista = new List<Pontoapoio>();                  try             {                 conn.Open();                 dr = comm.ExecuteReader(CommandBehavior.CloseConnection);                      while (dr.Read())                     {                     Pontoapoio unitario = new Pontoapoio();                          unitario.idpontoapoio = dr.IsDBNull(0) ? 0 : dr.GetInt32(0);                     unitario.descricao = dr.IsDBNull(1) ? "" : dr.GetString(1);                     unitario.idassociado = dr.IsDBNull(2) ? 0 : dr.GetInt32(2);                     unitario.tipoendereco = dr.IsDBNull(3) ? 0 : dr.GetInt32(3);                     unitario.logradouro = dr.IsDBNull(4) ? "" : dr.GetString(4);                     unitario.numero = dr.IsDBNull(5) ? "" : dr.GetString(5);                     unitario.complemento = dr.IsDBNull(6) ? "" : dr.GetString(6);                     unitario.bairro = dr.IsDBNull(7) ? "" : dr.GetString(7);                     unitario.cidade = dr.IsDBNull(8) ? "" : dr.GetString(8);                     unitario.estado = dr.IsDBNull(9) ? "" : dr.GetString(9);                          lista.Add(unitario);                     }             }             catch (Exception ex)             {                 string ERRO = ex.Message;                 return new List<Pontoapoio>();             }             finally             { conn.Close(); }                  return lista;         }              public Pontoapoio Get(int primary_key)         {             MySqlConnection conn = new MySqlConnection(connect);             System.Text.StringBuilder query = new System.Text.StringBuilder();             query.Append("select idpontoapoio, descricao, idassociado, tipoendereco, logradouro, numero, complemento, bairro, cidade, estado from pontoapoio where idpontoapoio = @idpontoapoio");                  MySqlCommand comm = new MySqlCommand(query.ToString(), conn);             comm.Parameters.Add("@idpontoapoio", MySqlDbType.Int32);             comm.Parameters[0].Value = primary_key;             MySqlDataReader dr = null;             Pontoapoio lista = new Pontoapoio();             try             {                 conn.Open();                 dr = comm.ExecuteReader(CommandBehavior.CloseConnection);                      while (dr.Read())                     {                     Pontoapoio unitario = new Pontoapoio();                          unitario.idpontoapoio = dr.IsDBNull(0) ? 0 : dr.GetInt32(0);                     unitario.descricao = dr.IsDBNull(1) ? "" : dr.GetString(1);                     unitario.idassociado = dr.IsDBNull(2) ? 0 : dr.GetInt32(2);                     unitario.tipoendereco = dr.IsDBNull(3) ? 0 : dr.GetInt32(3);                     unitario.logradouro = dr.IsDBNull(4) ? "" : dr.GetString(4);                     unitario.numero = dr.IsDBNull(5) ? "" : dr.GetString(5);                     unitario.complemento = dr.IsDBNull(6) ? "" : dr.GetString(6);                     unitario.bairro = dr.IsDBNull(7) ? "" : dr.GetString(7);                     unitario.cidade = dr.IsDBNull(8) ? "" : dr.GetString(8);                     unitario.estado = dr.IsDBNull(9) ? "" : dr.GetString(9);                          lista = unitario;                     }             }             catch (Exception ex)             {                 string ERRO = ex.Message;                 return new Pontoapoio();             }             finally             { conn.Close(); }                  return lista;         }    public int Post(Pontoapoio pontoapoio)    {        MySqlConnection conn = new MySqlConnection(connect);        System.Text.StringBuilder query = new System.Text.StringBuilder();        query.Append("insert into pontoapoio (descricao, idassociado, tipoendereco, logradouro, numero, complemento, bairro, cidade, estado) values (@descricao, @idassociado, @tipoendereco, @logradouro, @numero, @complemento, @bairro, @cidade, @estado)");        MySqlCommand comm = new MySqlCommand(query.ToString(), conn);        comm.Parameters.Add("@descricao", MySqlDbType.VarChar );        comm.Parameters.Add("@idassociado", MySqlDbType.Int32 );        comm.Parameters.Add("@tipoendereco", MySqlDbType.Int32 );        comm.Parameters.Add("@logradouro", MySqlDbType.VarChar );        comm.Parameters.Add("@numero", MySqlDbType.VarChar );        comm.Parameters.Add("@complemento", MySqlDbType.VarChar );        comm.Parameters.Add("@bairro", MySqlDbType.VarChar );        comm.Parameters.Add("@cidade", MySqlDbType.VarChar );        comm.Parameters.Add("@estado", MySqlDbType.VarChar );        comm.Parameters[0].Value = pontoapoio.descricao;        comm.Parameters[1].Value = pontoapoio.idassociado;        comm.Parameters[2].Value = pontoapoio.tipoendereco;        comm.Parameters[3].Value = pontoapoio.logradouro;        comm.Parameters[4].Value = pontoapoio.numero;        comm.Parameters[5].Value = pontoapoio.complemento;        comm.Parameters[6].Value = pontoapoio.bairro;        comm.Parameters[7].Value = pontoapoio.cidade;        comm.Parameters[8].Value = pontoapoio.estado;        Int32 id = 0;        try        {            conn.Open();            comm.ExecuteNonQuery();            query.Clear();            query.Append("Select @@Identity");            comm.CommandText = query.ToString();            var resultado = comm.ExecuteScalar();            id = Convert.ToInt32(resultado);        }        catch (Exception ex)        {            string ERRO = ex.Message;            return 0;        }        finally        { conn.Close(); }        return id;    }    public int Put(Pontoapoio pontoapoio)    {        MySqlConnection conn = new MySqlConnection(connect);        System.Text.StringBuilder query = new System.Text.StringBuilder();        query.Append("update pontoapoio set idpontoapoio = @idpontoapoio, descricao = @descricao, idassociado = @idassociado, tipoendereco = @tipoendereco, logradouro = @logradouro, numero = @numero, complemento = @complemento, bairro = @bairro, cidade = @cidade, estado = @estado where idpontoapoio = @idpontoapoio");        MySqlCommand comm = new MySqlCommand(query.ToString(), conn);        comm.Parameters.Add("@idpontoapoio", MySqlDbType.Int32 );        comm.Parameters.Add("@descricao", MySqlDbType.VarChar );        comm.Parameters.Add("@idassociado", MySqlDbType.Int32 );        comm.Parameters.Add("@tipoendereco", MySqlDbType.Int32 );        comm.Parameters.Add("@logradouro", MySqlDbType.VarChar );        comm.Parameters.Add("@numero", MySqlDbType.VarChar );        comm.Parameters.Add("@complemento", MySqlDbType.VarChar );        comm.Parameters.Add("@bairro", MySqlDbType.VarChar );        comm.Parameters.Add("@cidade", MySqlDbType.VarChar );        comm.Parameters.Add("@estado", MySqlDbType.VarChar );        comm.Parameters[0].Value = pontoapoio.idpontoapoio;        comm.Parameters[1].Value = pontoapoio.descricao;        comm.Parameters[2].Value = pontoapoio.idassociado;        comm.Parameters[3].Value = pontoapoio.tipoendereco;        comm.Parameters[4].Value = pontoapoio.logradouro;        comm.Parameters[5].Value = pontoapoio.numero;        comm.Parameters[6].Value = pontoapoio.complemento;        comm.Parameters[7].Value = pontoapoio.bairro;        comm.Parameters[8].Value = pontoapoio.cidade;        comm.Parameters[9].Value = pontoapoio.estado;        try        {            conn.Open();            return comm.ExecuteNonQuery();        }        catch (Exception ex)        {            string ERRO = ex.Message;            return 0;        }        finally        { conn.Close(); }    }    public int Delete(int idpontoapoio)    {        MySqlConnection conn = new MySqlConnection(connect);        System.Text.StringBuilder query = new System.Text.StringBuilder();        query.Append("delete from pontoapoio where idpontoapoio = @idpontoapoio");        MySqlCommand comm = new MySqlCommand(query.ToString(), conn);        comm.Parameters.Add("@idpontoapoio", MySqlDbType.Int32 );        comm.Parameters[0].Value = idpontoapoio;        try        {            conn.Open();            return comm.ExecuteNonQuery();        }        catch (Exception ex)        {            string ERRO = ex.Message;            return 0;        }        finally        { conn.Close(); }    }   }}